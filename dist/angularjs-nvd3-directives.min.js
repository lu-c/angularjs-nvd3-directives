!function(){"use strict";nv.models.multiBarLineChart=function(){function chart(selection){return selection.each(function(data){var container=d3.select(this),that=this,availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;if(chart.update=function(){container.transition().duration(transitionDuration).call(chart)},chart.container=this,!defaultState){var key;defaultState={};for(key in state)defaultState[key]=state[key]instanceof Array?state[key].slice(0):state[key]}if(!(data&&data.data&&data.data.length&&data.data.filter(function(d){return d.values.length}).length)){var noDataText=container.selectAll(".nv-noData").data([noData]);return noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d}),chart}container.selectAll(".nv-noData").remove(),x=multibar.xScale(),y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([data]),gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g"),g=wrap.select("g");if(gEnter.append("g").attr("class","nv-x nv-axis"),gEnter.append("g").attr("class","nv-y nv-axis"),gEnter.append("g").attr("class","nv-barsWrap"),gEnter.append("g").attr("class","nv-linesWrap"),gEnter.append("g").attr("class","nv-legendWrap"),gEnter.append("g").attr("class","nv-controlsWrap"),showLegend&&(legend.width(availableWidth-controlWidth()),multibar.barColor()&&data.data.forEach(function(series,i){series.color=d3.rgb("#ccc").darker(1.5*i).toString()}),g.select(".nv-legendWrap").datum(data).call(legend),margin.top!=legend.height()&&(margin.top=legend.height(),availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom),g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+-margin.top+")")),showControls){var controlsData=[{key:"Grouped",disabled:multibar.stacked()},{key:"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]),g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+-margin.top+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")"),rightAlignYAxis&&g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)"),multibar.disabled(data.data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return!data.data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.data.filter(function(d){return!d.disabled}));barsWrap.transition().call(multibar);var watermark=availableHeight*(1-.01*data.line)+margin.top;if(_.each($(this).children("line"),function(line){$(line).remove()}),d3.select(this).append("line").attr({x1:margin.left,y1:watermark,x2:availableWidth+margin.left,y2:watermark}).style("stroke","#000"),showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0),g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis > g").selectAll("g");if(xTicks.selectAll("line, text").style("opacity",1),staggerLabels){var getTranslate=function(x,y){return"translate("+x+","+y+")"},staggerUp=5,staggerDown=17;xTicks.selectAll("text").attr("transform",function(d,i,j){return getTranslate(0,j%2==0?staggerUp:staggerDown)});var totalInBetweenTicks=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;g.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(d,i){return getTranslate(0,0===i||totalInBetweenTicks%2!==0?staggerDown:staggerUp)})}reduceXTicks&&xTicks.filter(function(d,i){return i%Math.ceil(data[0].values.length/(availableWidth/100))!==0}).selectAll("text, line").style("opacity",0),rotateLabels&&xTicks.selectAll(".tick text").attr("transform","rotate("+rotateLabels+" 0,0)").style("text-anchor",rotateLabels>0?"start":"end"),g.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}showYAxis&&(yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0),g.select(".nv-y.nv-axis").transition().call(yAxis)),legend.dispatch.on("stateChange",function(newState){state=newState,dispatch.stateChange(state),chart.update()}),controls.dispatch.on("legendClick",function(d,i){if(d.disabled){switch(controlsData=controlsData.map(function(s){return s.disabled=!0,s}),d.disabled=!1,d.key){case"Grouped":multibar.stacked(!1);break;case"Stacked":multibar.stacked(!0)}state.stacked=multibar.stacked(),dispatch.stateChange(state),chart.update()}}),dispatch.on("tooltipShow",function(e){tooltips&&showTooltip(e,that.parentNode)}),dispatch.on("changeState",function(e){"undefined"!=typeof e.disabled&&(data.forEach(function(series,i){series.disabled=e.disabled[i]}),state.disabled=e.disabled),"undefined"!=typeof e.stacked&&(multibar.stacked(e.stacked),state.stacked=e.stacked),chart.update()})}),chart}var x,y,multibar=nv.models.multiBar(),line=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=!0,showLegend=!0,showXAxis=!0,showYAxis=!0,rightAlignYAxis=!1,reduceXTicks=!0,staggerLabels=!1,rotateLabels=0,tooltips=!0,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" on "+x+"</p>"},state={stacked:!1},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=function(){return showControls?180:0},transitionDuration=250;multibar.stacked(!1),line.clipEdge(!1).padData(!0),xAxis.orient("bottom").tickPadding(7).highlightZero(!0).showMaxMin(!1).tickFormat(function(d){return d}),yAxis.orient(rightAlignYAxis?"right":"left").tickFormat(d3.format(",.1f")),controls.updateState(!1);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};return multibar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)}),multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)}),dispatch.on("tooltipHide",function(){tooltips&&nv.tooltip.cleanup()}),chart.dispatch=dispatch,chart.multibar=multibar,chart.line=line,chart.legend=legend,chart.xAxis=xAxis,chart.yAxis=yAxis,d3.rebind(chart,multibar,line,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","stacked","stackOffset","delay","barColor","groupSpacing"),chart.options=nv.utils.optionsFunc.bind(chart),chart.margin=function(_){return arguments.length?(margin.top="undefined"!=typeof _.top?_.top:margin.top,margin.right="undefined"!=typeof _.right?_.right:margin.right,margin.bottom="undefined"!=typeof _.bottom?_.bottom:margin.bottom,margin.left="undefined"!=typeof _.left?_.left:margin.left,chart):margin},chart.width=function(_){return arguments.length?(width=_,chart):width},chart.height=function(_){return arguments.length?(height=_,chart):height},chart.color=function(_){return arguments.length?(color=nv.utils.getColor(_),legend.color(color),chart):color},chart.showControls=function(_){return arguments.length?(showControls=_,chart):showControls},chart.showLegend=function(_){return arguments.length?(showLegend=_,chart):showLegend},chart.showXAxis=function(_){return arguments.length?(showXAxis=_,chart):showXAxis},chart.showYAxis=function(_){return arguments.length?(showYAxis=_,chart):showYAxis},chart.rightAlignYAxis=function(_){return arguments.length?(rightAlignYAxis=_,yAxis.orient(_?"right":"left"),chart):rightAlignYAxis},chart.reduceXTicks=function(_){return arguments.length?(reduceXTicks=_,chart):reduceXTicks},chart.rotateLabels=function(_){return arguments.length?(rotateLabels=_,chart):rotateLabels},chart.staggerLabels=function(_){return arguments.length?(staggerLabels=_,chart):staggerLabels},chart.tooltip=function(_){return arguments.length?(tooltip=_,chart):tooltip},chart.tooltips=function(_){return arguments.length?(tooltips=_,chart):tooltips},chart.tooltipContent=function(_){return arguments.length?(tooltip=_,chart):tooltip},chart.state=function(_){return arguments.length?(state=_,chart):state},chart.defaultState=function(_){return arguments.length?(defaultState=_,chart):defaultState},chart.noData=function(_){return arguments.length?(noData=_,chart):noData},chart.transitionDuration=function(_){return arguments.length?(transitionDuration=_,chart):transitionDuration},chart}}();